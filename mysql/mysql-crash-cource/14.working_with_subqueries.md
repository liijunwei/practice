+ 问题: 什么是子查询?
+ 问题: 如何使用子查询?

> 目前所见的都是简单的 select查询, 即从单个数据库表中检索数据的单挑语句

> SQL: 任何SQL语句都是查询, 但此术语一般指select语句;

SQL还允许创建子查询(subquery), 即嵌套在其他查询中的查询

+ 利用子查询进行过滤

[理解表结构和表关系](./00.create.sql)

```sql
-- 列出订购物品TNT2的所有客户
select * from orderitems where prod_id = 'TNT2';
select * from orders where order_num in (20005, 20007);

-- 1. 列出包含物品TNT2的所有订单的编号
select order_num from orderitems where prod_id = 'TNT2';
-- 2. 列出具有前一步列出的订单编号的所有客户的ID
select cust_id from orders where order_num in (20005, 20007);
-- 3. 列出前一步返回的所有客户ID的客户信息
select * from customers where cust_id in (10001, 10004);

-- 上述每个步骤都可以单独作为一个查询来执行
-- 可以把一条SELECT语句返回的结果用于另一条SELECT语句的WHERE子句

select * from customers where cust_id in (
  select cust_id from orders where order_num in (
    select order_num from orderitems where prod_id = 'TNT2'
  )
);

-- https://www.dpriver.com/pp/sqlformat.htm
SELECT *
FROM   customers
WHERE  cust_id IN (SELECT cust_id
                   FROM   orders
                   WHERE  order_num IN (SELECT order_num
                                        FROM   orderitems
                                        WHERE  prod_id = 'TNT2'));
```

